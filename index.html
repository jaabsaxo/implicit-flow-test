<!DOCTYPE HTML>    
<html>    
<head>
</head>
<body>


<script type="text/javascript">


function get_access_token() {

  const currenturl = window.location.href;
  arr = currenturl.split("=")
  console.log("arr", arr);

  s2 = arr[1];
  console.log("x2", s2);

  arr2 = s2.split("&");
  console.log("arr2", arr2);

  token = arr2[0];
  console.log("token x", token);

  return token;
}

function login() {
  const client_id = "add82f2f69d340249024017f2194adac";
  const stateString = "State" + Math.random().toString();
  const redirectUrl = "https://jaabsaxo.github.io/implicit-flow-test/";
  const url = "https://sim.logonvalidation.net/authorize?response_type=token&client_id="+client_id+"&state="+stateString+"&redirect_uri="+redirectUrl;

  const options = {
    method: 'GET',
    mode: 'no-cors',
    redirect: 'follow'
  };
  console.log("log in..");
  window.open(url, '_blank');
}

function CheckToken() {
  const token = get_access_token();
  const TokenDict = {
    'method': 'GET',
    'headers': { 'Authorization': 'Bearer ' + token }
  }
  fetch("https://gateway.saxobank.com/sim/openapi/port/v1/clients/me", TokenDict).then(response => response.json()).then(data => {
    console.log("Logged in as", data.ClientId)
  })
}   


var countDownDate = new Date("Jan 5, 2024 15:37:25").getTime();

var x = setInterval(function() {

// Get today's date and time
var now = new Date().getTime();

// Find the distance between now and the count down date
var distance = countDownDate - now;

// Time calculations for days, hours, minutes and seconds
var days = Math.floor(distance / (1000 * 60 * 60 * 24));
var hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
var minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
var seconds = Math.floor((distance % (1000 * 60)) / 1000);

// Display the result in the element with id="demo"
document.getElementById("demo").innerHTML = days + "d " + hours + "h "
+ minutes + "m " + seconds + "s ";

// If the count down is finished, write some text
if (distance < 0) {
  clearInterval(x);
  document.getElementById("demo").innerHTML = "EXPIRED";
}
}, 1000);

</script>
<h3>v0.0.5</h3>
<button onclick="login()">Login</button>
<button onclick="CheckToken()">Check Token</button>
<p id="demo"></p>

</body>
</html>